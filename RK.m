function [u] = RK(ode,t,u,k)
global h
%

f = fcnchk(ode);

switch k
      case 2
        
        K(:,1) = h * f(t,u);
        K(:,2) = h * f(t + h/2 , u + 1/2 * K(:,1));
                
        u = u +  K(:,2); 
      
      case 3
        
        K(:,1) = h * f(t,u);
        K(:,2) = h * f(t + h/2 , u + 1/2 * K(:,1));
        K(:,3) = h * f(t + h , u - K(:,1) + 2 * K(:,2));
        
        u = u + 1/6 * (K(:,1) + 4 * K(:,2) + K(:,3));
        
      case 4
        
        K(:,1) = h * f(t,u);
        K(:,2) = h * f(t + h/2 , u + 1/2 * K(:,1));
        K(:,3) = h * f(t + h/2 , u + 1/2 * K(:,2));
        K(:,4) = h * f(t + h   , u +       K(:,3));

        u = u + 1/6 * (K(:,1) + 2 * K(:,2) + 2 * K(:,3) + K(:,4));
        
      case 6
        
        K(:,1) = h * f(t,u);
        K(:,2) = h * f(t +     h/3 , u + K(:,1)/3);
        K(:,3) = h * f(t + 2 * h/5 , u + ( 6 * K(:,2) +  4 * K(:,1))/25);
        K(:,4) = h * f(t + h       , u + (15 * K(:,3) - 12 * K(:,2) + K(:,1))/4);
        K(:,5) = h * f(t + 2 * h/3 , u + ( 8 * K(:,4) - 50 * K(:,3) + 90 * K(:,2) + 6* K(:,1))/81);
        K(:,6) = h * f(t + 4 * h/5 , u + ( 8 * K(:,4) + 10 * K(:,3) + 36 * K(:,2) + 6* K(:,1))/75);
        
        u = u + 1/192 * (23 * K(:,1) + 125 * K(:,3)- 81 * K(:,5) + 125 * K(:,6));         
 
      case 8
        
        K(:,1) = h * f(t,u);
        K(:,2) = h * f(t +  h/9 , u + K(:,1)/9);
        K(:,3) = h * f(t +  h/6 , u + (3 * K(:,2) +      K(:,1))/24);
        K(:,4) = h * f(t +  h/3 , u + (4 * K(:,3) -  3 * K(:,2) + K(:,1))/6);
        K(:,5) = h * f(t +  h/2 , u + (6 * K(:,4) - 24 * K(:,3) +  27 * K(:,2) -   5 * K(:,1))/8);
        K(:,6) = h * f(t +2*h/3 , u + (    K(:,5) -102 * K(:,4) + 867 * K(:,3) - 981 * K(:,2) +  221 * K(:,1))/9);
        K(:,7) = h * f(t +5*h/6 , u + (3 * K(:,6) + 80 * K(:,5) -  66 * K(:,4) - 472 * K(:,3) +  678 * K(:,2) -  183 * K(:,1))/48);
        K(:,8) = h * f(t +  h   , u + (72* K(:,7) -  9 * K(:,6) - 454 * K(:,5) + 834 * K(:,4) + 1002 * K(:,3) - 2072 * K(:,2) + 716 * K(:,1))/82);        
        
        u = u + 1/840 * (41 * (K(:,1) + K(:,8))+ 216 * (K(:,3) + K(:,7))+ 27 * (K(:,4) + K(:,6)) + 272 * K(:,5));         
        
        

end






